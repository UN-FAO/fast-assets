'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},waitingDialog=waitingDialog||function(a){'use strict';var b=a('<div class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true" style="padding-top:15%; overflow-y:visible;"><div class="modal-dialog modal-m"><div class="modal-content"><div class="modal-header"><h3 style="margin:0;"></h3></div><div class="modal-body"><div class="progress progress-striped active" style="margin-bottom:0;"><div class="progress-bar" style="width: 100%"></div></div></div></div></div></div>');return{show:function show(){var f='Loading...',g={};'undefined'==typeof g&&(g={}),'undefined'==typeof f&&(f='Loading');var h=a.extend({dialogSize:'m',progressType:'',onHide:null},g);b.find('.modal-dialog').attr('class','modal-dialog').addClass('modal-'+h.dialogSize),b.find('.progress-bar').attr('class','progress-bar'),h.progressType&&b.find('.progress-bar').addClass('progress-bar-'+h.progressType),b.find('h3').text(f),'function'==typeof h.onHide&&b.off('hidden.bs.modal').on('hidden.bs.modal',function(){h.onHide.call(b)}),b.modal()},hide:function hide(){b.modal('hide')}}}(jQuery),screenshotDialog=screenshotDialog||function(a){'use strict';var b=a('<div class="modal fade" data-backdrop="static" data-keyboard="false" tabindex="-1" role="dialog" aria-hidden="true" style="padding-top:5%; overflow-y:visible;"><div class="modal-dialog modal-m"><div class="modal-content"><div class="modal-header"><h3 style="margin:0;"></h3></div><div class="modal-body text-center"><video autoplay style="border: 1px solid #ddd; width: 400px; height: 300px;"></video><hr/><img src="" width="400px" height="300px" style="border: 1px solid #ddd;"><p><small class="text-muted">actual image size (<span></span>)</small></p></div><div class="modal-footer"><div class="row"><div class="col col-md-4"><button class="btn btn-danger btn-block btn-cancel-screenshot">Cancel</button></div><div class="col col-md-4"><button class="btn btn-default btn-block btn-capture-screenshot">Take Picture</button></div><div class="col col-md-4"><button class="btn btn-success btn-block btn-accept-screenshot" disabled="disabled">Accept</button></div></div></div></div></div></div>'),f=b.find('video').get(0),g=b.find('.btn-capture-screenshot').get(0),h=b.find('.btn-cancel-screenshot').get(0),i=b.find('.btn-accept-screenshot').get(0),j=b.find('img').get(0),k=b.find('span').get(0),l=0,m=['grayscale','sepia','blur','brightness','contrast','hue-rotate','hue-rotate2','hue-rotate3','saturate','invert',''];return{show:function show(n){var o=n.message,p=n.options,q=n.media,s=n.done,t=n.error,u=n.width,w=n.height;j.src=n.placeholder||'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=',n.hasOwnProperty('options')&&(p=n.options),n.hasOwnProperty('message')&&(o=n.message),n.hasOwnProperty('media')&&(q=n.media),n.hasOwnProperty('done')&&'function'==typeof n.done&&(s=n.done),n.hasOwnProperty('error')&&'function'==typeof n.error&&(t=n.error),n.hasOwnProperty('width')&&'number'==typeof n.width&&(u=n.width,j.width=400>u?u:j.width),n.hasOwnProperty('height')&&'number'==typeof n.height&&(w=n.height,j.height=w),n.hasOwnProperty('filters')&&(m=n.filters),k.innerText=u+'x'+w,f.onclick=function(){f.className=m[l++%m.length]},g.onclick=function(){try{var y=document.createElement('canvas'),z=y.getContext('2d');y.width=u,y.height=w;var A=1,B=getComputedStyle(f);0.5>u/f.videoWidth||0.5>w/f.videoHeight?A=0.5:(1.5<u/f.videoWidth||1.5<w/f.videoHeight)&&(A=1.5);var C=document.createElement('canvas'),D=C.getContext('2d');C.width=f.videoWidth*A,C.height=f.videoHeight*A,D.drawImage(f,0,0,C.width,C.height),'undefined'!=typeof z.filter&&(z.filter=B.filter||''),z.drawImage(C,0,0,C.width,C.height,0,0,y.width,y.height),j.src=y.toDataURL('image/png'),i.disabled=!1}catch(E){t(E)}},i.onclick=function(){f.srcObject.getTracks()[0].stop(),s([{storage:'base64',type:'image/png',url:j.src,name:'screenshot-'+uuidv4()+'.png',originalName:'screenshot.png',size:Math.round(3*j.src.split(',')[1].length/4)}]),b.modal('hide')},h.onclick=function(){f.srcObject&&f.srcObject.getTracks()[0].stop(),s(null),b.modal('hide')};var x=a.extend({dialogSize:'m',progressType:'',onHide:null},p);b.find('.modal-dialog').attr('class','modal-dialog').addClass('modal-'+x.dialogSize),b.find('h3').text(o),'function'==typeof x.onHide&&b.off('hidden.bs.modal').on('hidden.bs.modal',function(){x.onHide.call(b)}),null!==q&&q.then(function(y){f.srcObject=y,b.modal()}).catch(t)}}}(jQuery);function uuidv4(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(a){var b=0|16*Math.random(),d='x'==a?b:8|3&b;return d.toString(16)})}function getLocation(a){return a='object'===('undefined'==typeof a?'undefined':_typeof(a))&&null!==a?a:{},a.message=a.message||'Getting your location...',a.options=a.options||{dialogSize:'sm',progressType:'info'},waitingDialog.show(a),new Promise(function(b,d){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(f){waitingDialog.hide(),b({lat:f.coords.latitude,lng:f.coords.longitude})}):(waitingDialog.hide(),d('geolocation not available'))})}function takeScreenshot(a){return a='object'===('undefined'==typeof a?'undefined':_typeof(a))&&null!==a?a:{},a.width=a.width||400,a.height=a.height||300,a.message=a.message||'Take Screenshot',a.options=a.options||{},new Promise(function(b,d){!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)||(a.media=navigator.mediaDevices.getUserMedia({video:!0}),!a.media&&d('no media available'),a.done=b,a.error=d,screenshotDialog.show(a))})}